<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" type="text/html" href="https://ctrl-q.ptarmiganlabs.com/docs/command/qseow/import/master-item/">
<link rel="alternate" type="application/rss&#43;xml" href="https://ctrl-q.ptarmiganlabs.com/docs/command/qseow/import/master-item/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Master items | Ctrl-Q</title>
<meta name="description" content="Import master items into Qlik Sense">
<meta property="og:url" content="https://ctrl-q.ptarmiganlabs.com/docs/command/qseow/import/master-item/">
  <meta property="og:site_name" content="Ctrl-Q">
  <meta property="og:title" content="Master items">
  <meta property="og:description" content="Import master items into Qlik Sense">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">

  <meta itemprop="name" content="Master items">
  <meta itemprop="description" content="Import master items into Qlik Sense">
  <meta itemprop="dateModified" content="2024-11-15T18:40:25+01:00">
  <meta itemprop="wordCount" content="1703">
  <meta itemprop="keywords" content="Master-Item">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Master items">
  <meta name="twitter:description" content="Import master items into Qlik Sense">
<link rel="preload" href="/scss/main.min.abae8d77a318db1f7dc3e48a2c40326c72fe9d164313d815da846b0968944efc.css" as="style" integrity="sha256-q66Nd6MY2x99w&#43;SKLEAybHL&#43;nRZDE9gV2oRrCWiUTvw=" crossorigin="anonymous">
<link href="/scss/main.min.abae8d77a318db1f7dc3e48a2c40326c72fe9d164313d815da846b0968944efc.css" rel="stylesheet" integrity="sha256-q66Nd6MY2x99w&#43;SKLEAybHL&#43;nRZDE9gV2oRrCWiUTvw=" crossorigin="anonymous">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>
<script defer data-domain="ctrl-q.ptarmiganlabs.com" src="https://plausible.io/js/script.js"></script>

<link rel="canonical" href="https://ctrl-q.ptarmiganlabs.com/docs/command/qseow/import/master-item/" />
  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar js-navbar-scroll" data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">Ctrl-Q</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/about/"><span>About</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="/docs/"><span>Docs</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/docs/command/qseow/import/master-item/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Master items</h1>
<div class="lead">Import master items into Qlik Sense</div>




    <ul>
    
  
  
  
  

  

    </ul>


<div class="content">
      <!-- 

<div class="pageinfo pageinfo-primary">
<p>This is a placeholder page that shows you how to use this template site.</p>

</div>
 -->
<p><em>Page contents:</em></p>
<ul>
<li><a href="/docs/command/qseow/import/master-item/#import-master-items-from-excel-file">Import master items from Excel file</a>
<ul>
<li><a href="/docs/command/qseow/import/master-item/#syntax">Syntax</a></li>
<li><a href="/docs/command/qseow/import/master-item/#example">Example</a></li>
<li><a href="/docs/command/qseow/import/master-item/#how-to-get-correct-color-jsons">How to get correct color JSONs</a></li>
</ul>
</li>
</ul>
<hr>
<p>All example below use Windows Terminal/PowerShell.</p>
<h2 id="import-master-items-from-excel-file">Import master items from Excel file</h2>
<p>This command imports dimensions and measures defined in an Excel file into master items in a Sense app.</p>
<p>Both single and drill-down dimensions can be created (i.e. the same types that can be created using the Sense web UI), as well as measures.<br>
The same coloring options are available as in the web UI for both dimensions and measures.</p>
<h3 id="syntax">Syntax</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>PS C:\tools\ctrl-q&gt; .\ctrl-q.exe qseow master-item-import --help
</span></span><span style="display:flex;"><span>Usage: ctrl-q qseow master-item-import [options]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>create master items based on definitions in a file on disk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Options:
</span></span><span style="display:flex;"><span>  --log-level &lt;level&gt;                                          log level (choices: &#34;error&#34;, &#34;warn&#34;, &#34;info&#34;, &#34;verbose&#34;, &#34;debug&#34;, &#34;silly&#34;, default: &#34;info&#34;)
</span></span><span style="display:flex;"><span>  --host &lt;host&gt;                                                Qlik Sense server IP/FQDN
</span></span><span style="display:flex;"><span>  --port &lt;port&gt;                                                Qlik Sense server engine port (usually 4747 for cert auth, 443 for jwt auth) (default: &#34;4747&#34;)
</span></span><span style="display:flex;"><span>  --schema-version &lt;string&gt;                                    Qlik Sense engine schema version (default: &#34;12.612.0&#34;)
</span></span><span style="display:flex;"><span>  --app-id &lt;id&gt;                                                Qlik Sense app ID
</span></span><span style="display:flex;"><span>  --virtual-proxy &lt;prefix&gt;                                     Qlik Sense virtual proxy prefix (default: &#34;&#34;)
</span></span><span style="display:flex;"><span>  --secure &lt;true|false&gt;                                        https connection to Qlik Sense must use correct certificate. Invalid certificates will result in rejected/failed connection. (default: true)
</span></span><span style="display:flex;"><span>  --auth-user-dir &lt;directory&gt;                                  user directory for user to connect with
</span></span><span style="display:flex;"><span>  --auth-user-id &lt;userid&gt;                                      user ID for user to connect with
</span></span><span style="display:flex;"><span>  -a, --auth-type &lt;type&gt;                                       authentication type (choices: &#34;cert&#34;, &#34;jwt&#34;, default: &#34;cert&#34;)
</span></span><span style="display:flex;"><span>  --auth-cert-file &lt;file&gt;                                      Qlik Sense certificate file (exported from QMC) (default: &#34;./cert/client.pem&#34;)
</span></span><span style="display:flex;"><span>  --auth-cert-key-file &lt;file&gt;                                  Qlik Sense certificate key file (exported from QMC) (default: &#34;./cert/client_key.pem&#34;)
</span></span><span style="display:flex;"><span>  --auth-root-cert-file &lt;file&gt;                                 Qlik Sense root certificate file (exported from QMC) (default: &#34;./cert/root.pem&#34;)
</span></span><span style="display:flex;"><span>  --auth-jwt &lt;jwt&gt;                                             JSON Web Token (JWT) to use for authentication with Qlik Sense server
</span></span><span style="display:flex;"><span>  -t, --file-type &lt;type&gt;                                       source file type (choices: &#34;excel&#34;, default: &#34;excel&#34;)
</span></span><span style="display:flex;"><span>  --file &lt;filename&gt;                                            file containing master item definitions
</span></span><span style="display:flex;"><span>  --sheet &lt;name&gt;                                               name of Excel sheet where dim/measure flag column is found
</span></span><span style="display:flex;"><span>  --col-ref-by &lt;reftype&gt;                                       how to refer to columns in the source file. Options are by name or by position (zero based) (choices: &#34;name&#34;, &#34;position&#34;, default: &#34;name&#34;)
</span></span><span style="display:flex;"><span>  --col-item-type &lt;column position or name&gt;                    column where dim/measure flag is found. Use &#34;dim-single&#34; in that column to create dimension, &#34;dim-drilldown&#34; for drill-down dimension, &#34;measure&#34; for
</span></span><span style="display:flex;"><span>                                                               measure (default: &#34;Master item type&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-name &lt;column position or name&gt;             column number (zero based) or name to use as master item name (default: &#34;Master item name&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-descr &lt;column position or name&gt;            column number (zero based) or name to use as master item description (default: &#34;Description&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-label &lt;column position or name&gt;            column number (zero based) or name to use as master item label (default: &#34;Label&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-expr &lt;column position or name&gt;             column number (zero based) or name to use as master item expression (default: &#34;Expression&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-tag &lt;column position or name&gt;              column number (zero based) or name to use as master item tags (default: &#34;Tag&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-color &lt;column position or name&gt;            column number (zero based) or name to use as color for dimensions/measures (default: &#34;Color&#34;)
</span></span><span style="display:flex;"><span>  --col-master-item-per-value-color &lt;column position or name&gt;  column number (zero based) or name to use as per-value/segment color for dimensions/measures (default: &#34;Per value color&#34;)
</span></span><span style="display:flex;"><span>  --sleep-between-imports &lt;milliseconds&gt;                       sleep this many milliseconds between imports. Set to 0 to disable (default: 1000)
</span></span><span style="display:flex;"><span>  --limit-import-count &lt;number&gt;                                import at most x number of master items from the Excel file. Defaults to 0 = no limit (default: 0)
</span></span><span style="display:flex;"><span>  --dry-run                                                    do a dry run, i.e. do not create or update anything - just show what would be done
</span></span><span style="display:flex;"><span>  -h, --help                                                   display help for command
</span></span></code></pre></div><p>There are several options that allow for a great deal of flexibility.<br>
For example, the <code>--col-ref-by</code> option determines whether the <code>--col-master-item-...</code> options refer to columns by position or name.
Column names will in most cases be easier to read and understand, but sometimes a zero-based column position might be preferred.</p>
<p>Similarly those <code>--col-master-item-...</code> options let you use your own column names in the source file.</p>
<p>By adding the <code>--help</code> option when running Ctrl-Q you get a list of all available options for the <code>master-item-import</code> command.<br>
<code>--help</code> can be added to any Ctrl-Q command, even if there are already other options on the command line.</p>
<p>Some other options that might be useful:</p>
<ul>
<li><code>--dry-run</code>- Don&rsquo;t actually create or update any master items, just show what would have been done.</li>
<li><code>--limit-import-count</code> - Only import the first N master items from the file. Useful for testing.</li>
<li><code>--sleep-between-imports</code> - Pause for N milliseconds between each imported master item. Useful for decreasing the load on the Sense server.</li>
</ul>
<p>Notes on using the <code>master-item-import</code> command:</p>
<ul>
<li>
<p>Master items are referred to by name. This means that if a master item in the source file already exists in the target Sense app, the app&rsquo;s master item will be updated.</p>
</li>
<li>
<p>If a master item <em>does not</em> exist in the target app the master item will be created.</p>
</li>
<li>
<p>If a master item <em>does</em>_* exist in the target app its content will be overwritten with the info in the source Excel file.</p>
</li>
<li>
<p>The structure of the Excel file is fairly flexible, but some restrictions apply:</p>
<ul>
<li>The columns can be named anything. Use the <code>--col-item-type</code> and <code>--col-master-item-...</code> columns to tell Ctrl-Q which columns contains what data.</li>
<li>The first row in the Excel sheet must contain column headers if columns are referenced by name.</li>
</ul>
</li>
<li>
<p>Master item names, descriptions and labels can contain <em>almost</em> any characters and there are some restrictions on the length of these strings.</p>
<ul>
<li>See the <a href="https://help.qlik.com/en-US/sense/May2023/Subsystems/Hub/Content/Sense_Hub/Introduction/guidelines-visualizations-fields-naming.htm">Qlik Sense help</a> for details.</li>
<li>If a master item name or description is too long a warning will be shown and the text will be truncated to the max length allowed by Sense (see the link above).</li>
<li>If a master item has more than 30 tags a warning will be shown and only the first 30 tags will be used.</li>
<li>If a master item tag is longer than 31 characters a warning will be shown and the tag will be truncated to 31 characters.</li>
<li>If a master item expression is too long an error will be shown and Ctrl-Q will exit.
Notes on the example below:</li>
</ul>
</li>
<li>
<p>The (intentional) warning for the incorrectly spelled master item type &ldquo;measur&rdquo; (which should have been &ldquo;measure&rdquo;, of course).</p>
</li>
</ul>
<h3 id="example">Example</h3>
<p>Now let&rsquo;s run the command.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">.\</span><span style="color:#204a87">ctrl-q</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">exe</span> <span style="color:#000">qseow</span> <span style="color:#204a87">master-item</span><span style="color:#000">-import</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-host</span> <span style="color:#204a87">pro2-win1</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">lab</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">ptarmiganlabs</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">net</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-auth-user-dir</span> <span style="color:#000">LAB</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-auth-user-id</span> <span style="color:#000">goran</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-auth-type</span> <span style="color:#000">cert</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-app-id</span> <span style="color:#000">a3e0f5d2</span><span style="color:#000;font-weight:bold">-</span><span style="color:#000">000a</span><span style="color:#000;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">464f</span><span style="color:#000;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">998d</span><span style="color:#000;font-weight:bold">-</span><span style="color:#000">33d333b175d7</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#ce5c00;font-weight:bold">-file</span><span style="color:#000">-type</span> <span style="color:#000">excel</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#ce5c00;font-weight:bold">-file</span> <span style="color:#000;font-weight:bold">./</span><span style="color:#204a87">ctrl-q</span><span style="color:#000">-master-items</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">xlsx</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-sheet</span> <span style="color:#000">Sales</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-ref-by</span> <span style="color:#000">name</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-item-type</span> <span style="color:#4e9a06">&#34;Master item type&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-name</span> <span style="color:#4e9a06">&#34;Master Item Name&#34;</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-descr</span> <span style="color:#000">Description</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-label</span> <span style="color:#000">Label</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-expr</span> <span style="color:#000">Expression</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-tag</span> <span style="color:#000">Tag</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-color</span> <span style="color:#000">Color</span> <span style="color:#000;font-weight:bold">`</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#000">-col-master-item-per-value-color</span> <span style="color:#4e9a06">&#39;Per value color&#39;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>2024-11-19T07:07:31.858Z info: -----------------------------------------------------------
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | Ctrl-Q
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: |
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | Version      : 4.1.0
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | Log level    : info
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: |
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | Command      : master-item-import
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: |              : create master items based on definitions in a file on disk
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: |
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | Run Ctrl-Q with the &#39;--help&#39; option to see a list of all available options for this command.
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: |
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: | https://github.com/ptarmiganlabs/ctrl-q
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: ----------------------------------------------------------
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info:
</span></span><span style="display:flex;"><span>2024-11-19T07:07:31.873Z info: Import master items from definitions in Excel file &#34;./ctrl-q-master-items.xlsx&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:32.936Z info: (1/12) Updated existing measure &#34;No. of sold units&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:33.983Z info: (2/12) Updated existing measure &#34;No. of sold units (LY)&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:34.998Z info: (3/12) Updated existing measure &#34;Revenue EUR&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:36.024Z info: (4/12) Updated existing measure &#34;Revenue EUR (LY)&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:37.040Z info: (5/12) Updated existing measure &#34;Profit EUR&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:38.068Z warn: (6/12) Found an unknown master item type: &#34;measur&#34;. Ignoring this line in the imported file.
</span></span><span style="display:flex;"><span>2024-11-19T07:07:39.083Z info: (7/12) Updated existing measure &#34;Profit EUR (LY)&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:40.114Z info: (8/12) Updated existing dimension &#34;Country&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:41.162Z info: (9/12) Updated existing dimension &#34;Sales month&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:42.239Z info: (10/12) Updated existing dimension &#34;Salesperson&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:43.271Z info: (11/12) Updated existing dimension &#34;Color&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:44.318Z info: (12/12) Updated existing drill-down dimension &#34;DimDrill&#34;
</span></span><span style="display:flex;"><span>2024-11-19T07:07:45.334Z info: Imported 12 master items from Excel file ./ctrl-q-master-items.xlsx
</span></span></code></pre></div><blockquote>
<p>NOTE: A sample defintions Excel file is <a href="https://github.com/ptarmiganlabs/ctrl-q/blob/main/testdata/ctrl-q-master-items.xlsx?raw=true">available in the GitHub repository</a>. That file contains examples of most combinations of master item types and properties.</p>
</blockquote>
<h3 id="how-to-get-correct-color-jsons">How to get correct color JSONs</h3>
<p>If colors are to be associated with master items, the colors must be specified in JSON format, in the correct columns in the Excel file.</p>
<p>The easiest way to get the correct JSONs is to create a master item in the Sense web UI, set the master item&rsquo;s color, and then use Ctrl-Q&rsquo;s <code>master-item-dim-get</code> and <code>master-item-measure-get</code> commands to view the master item(s), either as a table or as JSON.<br>
This will show you what the structure of the JSON looks like, or even provide you with the correct JSON if you entered the desired color info in the Sense web UI.</p>
<p>Different master item types have different coloring options:</p>
<ul>
<li>Drill-down dimensions
<ul>
<li>A general dimension color set in the Excel file&rsquo;s column specified by the <code>--col-master-item-color</code> option.</li>
</ul>
</li>
<li>Single dimensions
<ul>
<li>A general dimension color set in the Excel file&rsquo;s column specified by the <code>--col-master-item-color</code> option.</li>
<li>A per-value color that can be used to assign different colors to different values of the dimension. Set in the Excel file&rsquo;s column specified by the <code>--col-master-item-per-value-color</code> option.</li>
</ul>
</li>
<li>Measures
<ul>
<li>A general measure color set in the Excel file&rsquo;s column specified by the <code>--col-master-item-color</code> option.</li>
<li>Segment colors that can be used to assign colors to value ranges of the measure. Set in the Excel file&rsquo;s column specified by the <code>--col-master-item-per-value-color</code> option.</li>
</ul>
</li>
</ul>
<p>Let&rsquo;s look at some examples.</p>
<p>Here we want to get the JSON for the color of the master dimension &ldquo;Country&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>.\ctrl-q.exe qseow master-item-dim-get `
</span></span><span style="display:flex;"><span>  --host pro2-win1.lab.ptarmiganlabs.net `
</span></span><span style="display:flex;"><span>  --auth-user-dir LAB `
</span></span><span style="display:flex;"><span>  --auth-user-id goran `
</span></span><span style="display:flex;"><span>  --app-id a3e0f5d2-000a-464f-998d-33d333b175d7 `
</span></span><span style="display:flex;"><span>  --output-format table
</span></span></code></pre></div><p>The result will be a rather wide table, where the column named <code>Coloring</code> contains the color JSONs.<br>
The color data for the &ldquo;Country&rdquo; dimension looks like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>Dimension color:
</span></span><span style="display:flex;"><span>{&#34;color&#34;:&#34;#bbbbbb&#34;,&#34;index&#34;:-1}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Value colors:
</span></span><span style="display:flex;"><span>{&#34;colors&#34;:[{&#34;value&#34;:&#34;Afghanistan&#34;,&#34;baseColor&#34;:{&#34;color&#34;:&#34;#8a85c6&#34;,&#34;index&#34;:-1}},{&#34;value&#34;:&#34;Albania&#34;,&#34;ba
</span></span><span style="display:flex;"><span>seColor&#34;:{&#34;color&#34;:&#34;#aaaaaa&#34;,&#34;index&#34;:-1}},{&#34;value&#34;:&#34;Algeria&#34;,&#34;baseColor&#34;:{&#34;color&#34;:&#34;#a16090&#34;,&#34;index&#34;:9
</span></span><span style="display:flex;"><span>}}],&#34;nul&#34;:{&#34;color&#34;:&#34;#c8c7a9&#34;,&#34;index&#34;:16},&#34;oth&#34;:{&#34;color&#34;:&#34;#ffec6e&#34;,&#34;index&#34;:-1},&#34;pal&#34;:null,&#34;single&#34;:nu
</span></span><span style="display:flex;"><span>ll,&#34;usePal&#34;:true,&#34;autoFill&#34;:true}
</span></span></code></pre></div><p>Let&rsquo;s format those as proper JSONs to make them more readable.<br>
These JSONs are what would go into the Excel file&rsquo;s <code>Color</code> and <code>Per-value color</code> columns.</p>
<blockquote>
<p>NOTE 1: If unsure about what data to put in some field, just use the ones returned by the <code>master-item-dim-get</code> command.<br>
NOTE 2: The same concept works for drill-down dimensions and measures.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#bbbbbb&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">-1</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;colors&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Afghanistan&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;baseColor&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#8a85c6&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">-1</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;Albania&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>      <span style="color:#204a87;font-weight:bold">&#34;baseColor&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;#aaaaaa&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;value&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;Algeria&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">&#34;baseColor&#34;</span><span style="color:#000;font-weight:bold">:{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#34;#a16090&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#0000cf;font-weight:bold">9</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">],</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;nul&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#c8c7a9&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">16</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;oth&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;color&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#34;#ffec6e&#34;</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">&#34;index&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#0000cf;font-weight:bold">-1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">},</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;pal&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;single&#34;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#a40000">nu</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a40000">ll</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;usePal&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>  <span style="color:#204a87;font-weight:bold">&#34;autoFill&#34;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div>
</div>
</div>


  
  
  
  

  
  

  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Ptarmigan Labs Newsletter" aria-label="Ptarmigan Labs Newsletter">
    <a target="_blank" rel="noopener" href="https://ptarmiganlabs.com/#/portal/signup" aria-label="Ptarmigan Labs Newsletter">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="LinkedIn" aria-label="LinkedIn">
    <a target="_blank" rel="noopener" href="https://www.linkedin.com/in/gorsan/" aria-label="LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/ptarmiganlabs/ctrl-q" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Get in touch with Ptarmigan Labs" aria-label="Get in touch with Ptarmigan Labs">
    <a target="_blank" rel="noopener" href="mailto://info@ptarmiganlabs.com" aria-label="Get in touch with Ptarmigan Labs">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2024
    <span class="td-footer__authors">Ptarmigan Labs AB</span></span><span class="td-footer__all_rights_reserved">All Rights Reserved</span><span class="ms-2"><a href="https://ptarmiganlabs.com/privacy-policy/" target="_blank" rel="noopener">Privacy Policy</a></span><p class="td-footer__about mt-2"><a href="/about/">About Ctrl-Q</a></p>
      </div>
    </div>
  </div>
</footer>

    </div>
    <script src="/js/main.min.9bb04dc6a6b4b104e1da6f6d5a885a4092b9a942c466820b75d34697477404c9.js" integrity="sha256-m7BNxqa0sQTh2m9tWohaQJK5qULEZoILddNGl0d0BMk=" crossorigin="anonymous"></script>
<script src='/js/prism.js'></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>
